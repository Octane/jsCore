/* js-core AJAX module, version 0.2.7 (minified)
   Copyright (c) 2009 Dmitry Korobkin
   Released under the MIT License.
   More information: http://www.js-core.ru/
	Warning: do not use timeout for more then 2 XHR at one time!
*/
core.ajax=function(){if(this.ajax)return new this.ajax();this.xhr=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest()};core.ajax.type={html:'text/html',text:'text/plain',xml:'application/xml, text/xml',json:'application/json, text/javascript',script:'text/javascript, application/javascript','default':'application/x-www-form-urlencoded'};core.ajax.accept='*\/*';core.ajax.prototype.open=function(c){core.extend(this,{method:c.method||'GET',url:c.url||location.href,async:c.async!==false,user:c.user||null,password:c.password||null,params:c.params||null,processData:c.processData===true,timeout:c.timeout||0,contentType:core.ajax.type[c.contentType]||core.ajax.type['default'],dataType:core.ajax.type[c.dataType]?core.ajax.type[c.dataType]+', *\/*':core.ajax.accept,requestHeaders:c.requestHeaders||null,success:c.success,error:c.error});if(this.params){var c=[],process=this.process;core.forEach(this.params,function(a,b){c.push([a,'=',process?encodeURIComponent(b):b].join(''))});this.params=c.join('&')}try{this.xhr.open(this.method,this.method=='GET'&&this.params?this.url+'?'+this.params:this.url,this.async,this.user,this.password);this.xhr.setRequestHeader('Accept',this.dataType);this.xhr.setRequestHeader('X-Requested-With','XMLHttpRequest');this.xhr.setRequestHeader('Content-Type',this.contentType);var d=this;if(this.requestHeaders)core.forEach(this.requestHeaders,function(a,b){d.xhr.setRequestHeader(a,b)});this.xhr.send(this.params);(function(){if(d.xhr.readyState==4){if(d.xhr.status==200||d.xhr.status==0&&d.success)d.success(d.xhr.responseText);else if(d.error&&!d.aborted)d.error(d.xhr.statusText)}else if(!d.aborted)setTimeout(arguments.callee,20)})();if(this.async&&this.timeout)setTimeout(function(){if(d.xhr.readyState!=4){d.xhr.abort();d.aborted=true;if(d.error)d.error('Time is out')}},this.timeout)}catch(error){if(this.error)this.error(error)}};core.get=function(a,b,c){new core.ajax().open(core.extend(a,{success:b,error:c}));return this};core.post=function(a,b,c){new core.ajax().open(core.extend(a,{method:'POST',success:b,error:c}));return this};core.getJSON=function(b,c,d){new core.ajax().open(core.extend(b,{dataType:'json',success:function(a){try{c(window.JSON&&JSON.parse?JSON.parse(a):eval('('+a+')'))}catch(d){if(this.error)this.error(d)}},error:d}));return this};core.prototype.load=function(c,d,e){var f=this;new core.ajax().open(core.extend(c,{success:function(a){var b=/^INPUT|BUTTON|TEXTAREA$/;f[b.test(f.node.tagName)?'val':'html'](a);if(d)d.call(f.node,a,this.xhr)},error:function(a){if(e)e.call(f.node,a,this.xhr)}}));return this};